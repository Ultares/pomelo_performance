package protocol;
import "Error.proto";
import "Item.proto";

enum TaskType {
  TASK_TYPE_INVALID = 0;

  TASK_TYPE_PVE = 1;                                  // 联赛挑战次数 key=1为普通副本，2为精英副本
  TASK_TYPE_ARENA = 2;                                // 挑战擂台赛次数 key=1
  TASK_TYPE_EXP = 3;                                  // 经验副本
  TASK_TYPE_RESOURCE = 4;                             // 材料消耗 key=item_id value=count
  TASK_TYPE_FRIEND = 5;                               // 好友互动
  TASK_TYPE_HERO = 6;                                 // 英雄之魂强化
  TASK_TYPE_FINISH_OTHERS = 7;                        // 做完其他日常任务

  ACHIEVE_TYPE_PVE_CHAPTER = 101;                     // 通关PVE中key难度的第value章节
  ACHIEVE_TYPE_LEVEL = 102;                           // key=1, value=等级
  ACHIEVE_TYPE_ARENA_RANK = 103;                      // key=1, value=擂台赛历史最高排名
  ACHIEVE_TYPE_TOUR_WIN_COUNT = 104;                  // key=1, value=巡回赛累计胜场
  ACHIEVE_TYPE_GLORY_INSTANCE = 105;                  // key=1, value=光辉时刻完成关卡
  ACHIEVE_TYPE_CARD_STAR_NUM = 106;                   // key=最低星数， value=选手数量
  ACHIEVE_TYPE_CARD_QUALITY_NUM = 107;                // key=1为S+，2为S以上 value=选手数量
  ACHIEVE_TYPE_FAN = 108;                             // 粉丝数量
  ACHIEVE_TYPE_CLUB_EVENT_NUM = 109;                  // key=1, value=完成俱乐部中心事件数量
  ACHIEVE_TYPE_ITEM_USED = 110;                       // key=1, value=消耗道具数量
};

message TaskData {
  optional uint32 task_id = 1;                        // 任务ID
  optional uint32 progress = 2;                       // 进度
  optional bool got_reward = 3;                       // True表示已经领过奖励了
}

message HonourData {
  optional uint32 task_id = 1;                        // 任务ID
  optional uint32 timestamp = 2;                      // 获得时间
}

message TaskInfo {
  repeated TaskData daily_tasks = 1;                  // 日常任务
  optional uint32 daily_task_timestamp = 2;           // 上次刷新日常任务的时间
  optional uint32 finished_daily_tasks = 3;           // 服务器用
  repeated TaskData achieve_tasks = 4;                // 未领过奖的成就
  repeated uint32 finished_achieve_tasks = 5;         // 领过奖的成就，成就领奖之后就从achieve_tasks中移除，放到这个数组里
  repeated HonourData honour_data = 6;                // 用于记录“荣誉殿堂”成就的获得时间
}

// 获取任务/成就相关信息
message C2S_TaskInfoRequest {
}
message S2C_TaskInfoResponse {
  optional TaskInfo task_info = 1;
}

// 每当有新的任务/成就、或任务/成就进度更新时，由服务器主动发送
message S2C_TaskDataUpdate {
  repeated TaskData daily_tasks = 1;                  // 更新的日常任务数据
  repeated TaskData achieve_tasks = 2;                // 更新的成就数据
  repeated uint32 removed_tasks = 3;                  // 删除的成就数据
  repeated uint32 new_finished_achieve_tasks = 4;     // 新增的领过奖的成就
  repeated HonourData new_honour_data = 5;            // 新增的用于记录“荣誉殿堂”成就的获得时间
}

// 领取任务/成就奖励
message C2S_TaskRewardRequest {
  optional uint32 task_id = 1;
}
message S2C_TaskRewardResponse {
  optional ErrorCode error_code = 1;
  repeated Item items = 2;                            // 只设置item_id,count字段
}
