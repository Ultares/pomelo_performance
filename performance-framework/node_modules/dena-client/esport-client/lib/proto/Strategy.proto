package protocol;
import "Team.proto";
import "Error.proto";

message StrategyEntry {
  optional ECardPosition card_position = 1;                   // 5个位置中的一个
  optional int32 radical_level = 2;                           // 激进程度（M_Player_Style.xlsx中的radicalLV）
}

message StrategyPosition {
  optional int32 type = 1;                                    // 1~4:4个战术位置中的一个
  optional int32 id = 2;                                      // 战术位置的ID
}

// 战略装配
message StrategyRecord {
  optional int32 index = 1;                                   // 1~N中的一个（N是标签页数量上限）
  optional string name = 2;
  repeated StrategyEntry strategy_entries = 3;
  repeated StrategyPosition strategy_positions = 4;
}

message StrategyInfo {
  repeated StrategyRecord strategy_records = 1;
  optional int32 current_record = 2;                          // 正在使用的战略装配的index
  optional int32 max_records = 3;                             // 页签数量上限
  optional int32 edit_record = 4;                             // 编辑中的装配的index
}

// 获取战术选择信息
message C2S_StrategyInfoRequest {
}
message S2C_StrategyInfoResponse {
  optional StrategyInfo strategy_info = 1;
}

// 设置战略装配（战斗外）
message C2S_StrategyRecordRequest {
  optional StrategyRecord strategy_record = 1;                // 需要设置或修改的战略装配
}
message S2C_StrategyRecordResponse {
  optional ErrorCode error_code = 1;
  optional StrategyRecord strategy_record = 2;                // 被设置或修改的战略装配
}

// 使用战略装配（战斗内）
message CardBattleForce {
  optional int32 refresh_id = 1;
  optional double battle_force = 2;
}
message C2S_StrategyUseRequest {
  optional int32 index = 1;                                   // 需要使用的战略装配的index，1~N中的一个
}
message S2C_StrategyUseResponse {
  optional ErrorCode error_code = 1;
  optional int32 index = 2;
  optional bool in_battle = 3;                                // 是否在战斗内
  repeated CardBattleForce battle_forces = 4;                 // 战斗内10个选手的战斗力
  repeated int32 strategy_position_ids = 5;                   // 选择的战术位置的ID
  repeated StrategyEntry strategy_entries = 6;                // 选择的每个位置的激进程度
}

// 记录编辑中的战略装配（战斗外）
message C2S_StrategyEditRequest {
  optional int32 index = 1;                                   // 需要记录的战略装配的index，1~N中的一个
}
message S2C_StrategyEditResponse {
  optional ErrorCode error_code = 1;
  optional int32 index = 2;
}

// 购买装配页签数量上限
message C2S_StrategyBuyRequest {
}
message S2C_StrategyBuyResponse {
  optional ErrorCode error_code = 1;
  optional int32 max_records = 2;                             // 新的页签数量上限
}

