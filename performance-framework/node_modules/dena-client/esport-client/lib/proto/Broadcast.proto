package protocol;
import "Common.proto";
import "Task.proto";

message BroadCastAnchor
{
    optional uint32 id = 1;     //直播编号
    optional uint32 level = 2;
    optional uint32 exp = 3; 
    optional uint32 contri = 4;
    optional uint32 chatindex = 5;  //记录上次已经得到的最大的聊天index
}

message GiftTask
{
    repeated TaskData daily_tasks = 1;
    repeated TaskData repeated_tasks = 2;
    optional uint32   tasktime = 3;             //每日任务操作时间
}

// 玩家保存
message BroadCastInfo
{
    repeated BroadCastAnchor anchors = 1;
    optional uint32 index = 2;  // 直播时间id,方便下次清除数据
    repeated UIntPair buyrecord = 3;  //商品购买记录
    optional GiftTask task = 4;
}

// 服务器需要保存的
message ServerBroadCast
{
    optional uint32 index = 1;
    repeated BroadCastRank ranks = 2;
}

message BroadCastContri
{
    optional uint64 playerid = 1;
    optional string name = 2;
    optional uint32 team = 3;       //战队
    optional uint32 contribute = 4; 
}

message BroadCastChat
{
    optional uint64 playerid = 1;
    optional string name = 2;
    optional string content = 3;
    optional uint32 index = 4;
}

message BroadCastRank 
{
    optional uint32 id = 1;
    repeated BroadCastContri contri = 2;    //排行榜
    repeated BroadCastChat chat = 3;
}


// 明星选手直播间信息请求
message C2S_AnchorRoomInfoRequest
{
}

message S2C_AnchorRoomInfoResponse
{
	optional int32 res = 1;				// res=0才有下面两条数据
	repeated BroadCastAnchor list = 2;
	optional uint32 leftsec = 3;		//下播剩余的秒数
    repeated UIntPair buyrecord = 4;   //商品购买记录
}

// 赠送主播礼物
message C2S_GiveGiftRequest
{
    optional uint32 roomid = 1;
    optional uint32 itemid = 2;
    optional uint32 itemnum = 3;
}

message S2C_GiveGiftResponse
{
    optional int32 res = 1;
    optional uint32 feedback_id = 2;
    optional uint32 lv = 3;              //粉丝等级提升的时候才发
    optional BroadCastAnchor anchor = 4; 
}

// 请求主播粉丝排行
message C2S_FansRankRequest
{
    optional uint32 roomid = 1;
    optional uint32 index = 2;      //聊天内容的编号,一条内容一个编号,发客户端保存的最大的编号
}


message S2C_FansRankResponse
{
    optional int32 res = 1;
    repeated BroadCastContri list = 2;  //排行榜
    repeated BroadCastChat chat = 3;    //留言
}

// 给主播留言
message C2S_ChatAnchorRequest
{
    optional uint32 roomid = 1;
    optional string content = 2;
    optional uint32 index = 3;      //聊天内容的编号,一条内容一个编号,发客户端保存的最大的编号
}

// 购买直播商店里面的物品
message C2S_BuyBroadcastShopRequest
{
    optional uint32 id = 1;         //商品配表id, Broadcast_Shop表里面的id
    optional uint32 num = 2;        //数量
}

message S2C_BuyBroadcastShopResponse
{
    optional int32 res = 1;         // 成功后,再请求C2S_AnchorRoomInfoRequest消息,刷新购买次数
}

// 请求礼物任务界面
message C2S_GiftTaskRequest
{

}

message S2C_GiftTaskResponse
{
    optional int32 res = 1;
    repeated TaskData daily_tasks = 2;     
    repeated TaskData repeated_tasks = 3;     
}

// 请求领取任务奖励
message C2S_GetGiftTaskRewardRequest
{
    optional uint32 task_id = 1;
}

message S2C_GetGiftTaskRewardResponse 
{
    optional uint32 res = 1;
}

// 礼物任务更新
message S2C_GiftTaskUpdate 
{
  repeated TaskData daily_tasks = 1;                  // 更新的日常任务数据
  repeated TaskData repeated_tasks = 2;               // 更新的成就数据
}